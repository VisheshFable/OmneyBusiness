# Omney Business Automation Script

Python automation script for testing the Omney Business application (https://qaoneob.remit.in).

## Test Cases Covered

| TC_ID | Test Scenario |
|-------|---------------|
| TC_01 | URL Verification - Check if URL is working |
| TC_02 | Login - Verify login with valid credentials |
| TC_03 | Raise Invoice - Create invoice and verify Request ID |

## Prerequisites

- Python 3.8 or higher
- Chrome browser (Chromium will be installed by Playwright)

## Installation

1. Navigate to the Scripts directory:
```bash
cd D:\Vishesh\OmneyBusiness\Scripts
```

2. Install required packages:
```bash
pip install -r requirements.txt
```

3. Install Playwright browsers:
```bash
playwright install chromium
```

## Usage

### Run all tests (with browser visible):
```bash
python omney_business_automation.py
```

### Run tests in headless mode:
Edit the script and change:
```python
automation = OmneyBusinessAutomation(headless=True)
```

## Test Data

Test data is read from:
- `D:\Vishesh\OmneyBusiness\Testcase\OB_Automation.xlsx`
  - Sheet: `Testcase` - Contains test case definitions
  - Sheet: `Invoice` - Contains invoice data for TC_03

### Login Credentials (TC_02):
- Username: visheshindindia@yopmail.com
- Password: Password@2

### Invoice Data (TC_03):
- Invoice Number: Auto-generated (INV-YYYYMMDD####)
- Invoice Date: Current date
- Due Date: Current date + 2 days
- Client: Haier Electronics
- Purpose: Demo Purpose
- Currency: INR
- Amount: 5000
- Bank Account: Bandhan Bank
- Document: D:\Vishesh\FAB\Test.png

## Output

### Reports Location:
`D:\Vishesh\OmneyBusiness\Reports\Python_Automation\`

### Generated Files:
- `TC_01_URL_Working_<timestamp>.png` - Homepage screenshot
- `TC_02_Login_Success_<timestamp>.png` - Dashboard after login
- `TC_03_Invoice_Form_Filled_<timestamp>.png` - Filled invoice form
- `TC_03_Invoice_Success_Popup_<timestamp>.png` - Success popup
- `TC_03_Dashboard_After_Invoice_<timestamp>.png` - Dashboard with invoice
- `Test_Report_<timestamp>.md` - Detailed test report

## Project Structure

```
D:\Vishesh\OmneyBusiness\
├── Scripts\
│   ├── omney_business_automation.py  # Main automation script
│   ├── requirements.txt              # Python dependencies
│   └── README.md                     # This file
├── Testcase\
│   └── OB_Automation.xlsx            # Test data
├── Reports\
│   ├── Python_Automation\            # Python script reports
│   └── ...                           # Manual test reports
└── ...
```

## Features

- **Automatic screenshot capture** for each test step
- **Detailed logging** with timestamps
- **Markdown report generation** with test results
- **Excel data-driven testing** for invoice details
- **Error handling** with failure screenshots
- **Configurable headless mode** for CI/CD

## Troubleshooting

### Issue: Browser not launching
```bash
playwright install chromium
```

### Issue: Excel file not found
Ensure the test data file exists at:
`D:\Vishesh\OmneyBusiness\Testcase\OB_Automation.xlsx`

### Issue: Invoice document not found
Ensure the test document exists at:
`D:\Vishesh\FAB\Test.png`

### Issue: Login fails
- Verify credentials are correct
- Check if the account is active
- Ensure network connectivity

## Author

Generated by Chrome DevTools MCP Automation
Date: 2026-01-06
